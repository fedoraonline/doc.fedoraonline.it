{{InCorso|autore=NomeAutore}}
__TOC__
== Introduzione ==
Fedora utilizza per le schede video NVidia (tra cui le GeForce) di default, senza necessità di configurazioni aggiuntive, il driver libero "[http://nouveau.freedesktop.org/wiki/ nouveau]. Si possono tuttavia utilizzare, al suo posto, il driver proprietario (non libero) ufficialmente fornito da Nvidia stessa. Questa guida spiega come installare quest'ultimo.

Per installare i driver nVidia  sono possibili, sostanzialmente, due metodi: tramite pacchetto rpm o tramite installer ufficiale.
{{Warning|Non usare mai i due metodi contemporaneamente, nel senso esclusivo della parola: o l'uno oppure l'altro.}}
Di seguito verranno descritti  entrambi.

=== Serie di schede video NVidia supportate ===
Come primo passo, bisogna sapere a quale [http://en.wikipedia.org/wiki/GeForce#Generations serie] appartiene la nostra scheda video. Per far ciò si può per esempio confrontare l'output del comando:
 # lspci|grep -i vga
con [http://en.wikipedia.org/wiki/Comparison_of_Nvidia_graphics_processing_units questa pagina di wikipedia], che elenca le gpu suddivise per serie. 
{{Warning|Se con pc portatile, al comando precedente vi evidenzia la presenza sia di una gpu nvidia che di una integrata intel, vuol dire che ha la tecnologia [http://en.wikipedia.org/wiki/Nvidia_Optimus Nvidia Optimus]che '''non''' è supportata dai driver NVidia per Linux.}}

Esistono infatti quattro driver diversi, a seconda della serie della scheda video:
*'''Serie 8 o superiori''', cioè schede video prodotte indicativamente a partire dal 2007 (GeForce 8xxx, 9xxx, 1xx, 2xx, 3xx, 4xx, 5xx, 6xx, 7xx): '''ultima versione del driver''';
*'''Serie 6 e 7''', cioè schede video prodotte indicativamente dal 2004 al 2006 (GeForce 6xxx, 7xxx): '''driver versione 304''';
*'''Serie 5''', cioè schede video prodotte indicativamente nel 2003 (GeForce FX 5xxx): '''driver versione 173''';
*'''Serie da 2 a 4''', cioè schede video prodotte indicativamente dal 2000 al 2002: '''driver versione 96'''.

NOTA: per fedora 19 e 20 attualmente non esistono driver aggiornati compatibili per schede serie 5 e precedenti.

==Installazione dei drivers usando akmod-nvidia==
{{Nota|Prerequisito|Per l'installazione via Yum è necessario installare e configurare preventivamente il repository di [[RPMFusion|RPMFusion]].}}
Per sicurezza dare un:
 # yum update rpmfusion*

=== Per versioni di Fedora 16 e successive ===
Per Fedora 16 attualmente sono disponibili driver proprietari Nvidia compatibili solo per GeForce serie 6 e superiori. La procedura di installazione è la seguente:

Installare i driver akmod-nvidia:
 # yum install akmod-nvidia

Accertare corretta riconfigurazione di grub2, con il proprio editor di testo (nell'esempio vim) aprire il seguente file:
 # vim /etc/default/grub
Controllare che la riga contenente la variabile '''GRUB_CMDLINE_LINUX=''' contenga alla fine queste stringhe ''nouveau.modeset=0 rd.driver.blacklist=nouveau'' come il file di esempio qui di seguito:
 # cat /etc/default/grub
 GRUB_TIMEOUT=5
 GRUB_DISTRIBUTOR="Fedora"
 GRUB_DEFAULT=saved
 GRUB_CMDLINE_LINUX="rd.md=0 rd.lvm=0 rd.dm=0 quiet SYSFONT=latarcyrheb-sun16 rhgb rd.luks=0  KEYTABLE=it LANG=en_US.UTF-8 nouveau.modeset=0 rd.driver.blacklist=nouveau"

Fare una copia di backup del file di configurazione di grub2:
 # cp /boot/grub2/grub.cfg /boot/grub2/grub.cfg.backup

Ricreare la configurazione di grub2:
 # grub2-mkconfig -o /boot/grub2/grub.cfg

Riavviare la macchina e controllare eventuali errori.

=== Per versioni precedenti a Fedora 16 ===
Ora occorre installare il pacchetto sviluppo del kernel:
 # yum install kernel-devel

Oppure '''kernel-PAE-devel''' se si usa il kernel-PAE; inoltre verificare che le
versioni di kernel e kernel-devel (o kernel-PAE-devel) "collìmino", cioè
corrispondano perfettamente:
 $ rpm -qa|grep kernel
e
 $ rpm -q kernel-devel

Verificare che la versione di kernel che si utilizza
corrisponda alla versione del kernel-devel.

In base al modello di videocard posseduta si potrà scegliere i drivers corretti per il proprio sistema:
*Se si possiede una nVidia GeForce serie 6 o superiore, fare
 # yum install akmod-nvidia
*Per una serie 5 (non ancora disponibili per Fedora 16)
 # yum install akmod-nvidia-173xx
*Per una serie da 2 a 4 (non ancora disponibili per Fedora 15 e 16)
 # yum install akmod-nvidia-96xx
Prima di riavviare il sistema, per evitare possibili problemi, è neccessario un ultimo passaggio:
 # mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r)-nouveau.img
 # dracut /boot/initramfs-$(uname -r).img $(uname -r)

L'installazione essenziale del driver Nvidia è terminata.

=== Ulteriori configurazioni ===
In alcuni casi, può essere utile effettuare ulteriori operazioni, che vengono spiegate in questo paragrafo.

==== Accelarazione video per applicazioni a 32 bit in Fedora 64 bit ====
Se si sta utilizzando una fedora a 64 bit, e si vuole che l'accelerazione video sia disponibile anche per le applicazioni a 32 bit, bisogna inoltre installare un ulteriore pacchetto: 
*Per una serie 8 o superiore 
 # yum install xorg-x11-drv-nvidia-libs.i686
*Per una serie 6 o 7 
 # yum install xorg-x11-drv-nvidia-304xx-libs.i686
*Per una serie 5
 # yum install xorg-x11-drv-nvidia-173xx-libs.i686
*Per una serie da 2 a 4
 # yum install xorg-x11-drv-nvidia-96xx-libs.i686

==== Decodifica filmati su gpu ====
Se si possiede una serie 8 o superiore, per poter usufruire della decodifica video offerta da VDPAU, bisogna aggiungere il pacchetto:
 # yum install libva-vdpau-driver

==== Risoluzione problemi monitor ====
Qualora il monitor non venga riconosciuto e la frequenza non sia quella indicata dal produttore, per una regolazione  più "fine" del display e si vuole impostare i valori corretti, ci si deve servire di questo tool di nvidia per farlo. 
Occorrono i permessi di root, quindi:
 $ su
 password
 # nvidia-settings

Da "X Server Display configuration" impostare la risoluzione e la frequenza a 60hz
e salvare il file nel xorg.conf con il bottone che è visualizzato nella GUI. 
Dopodichè aprire il file xorg.conf ed inserire le modifiche:

 # gedit /etc/X11/xorg.conf 
 Section "Monitor"
    # HorizSync source: edid, VertRefresh source: edid
    Identifier     "Monitor0"
    VendorName     "Unknown"
    ModelName      "Samsung SyncMaster 950B"
    HorizSync       30.0 - 81.0
    VertRefresh     56.0 - 75.0
    Option         "DPMS"
 EndSection

Da notare che la sovrascrittura da parte di nvidia-settings ha tolto il
path per il driver stesso, per cui non si avrà più il direct rendering attivo.
Inserite, quindi, nel "file section" quanto necessario:

 Section "Files"
     FontPath        "/usr/share/fonts/default/Type1"
     '''ModulePath   "/usr/lib/xorg/modules/extensions/nvidia"'''
     '''ModulePath   "/usr/lib/xorg/modules"'''
 EndSection

Da Fedora 16 questa modifica non dovrebbe essere necessaria.<br />
Salvare il proprio xorg.conf e riavviare il server X con <code>Ctrl+Alt+Backspace</code>.<br />
Verificare ora se tutto è andato come desiderato:

 $ glxgears
 37026 frames in 5.0 seconds = 7405.197 FPS
 29492 frames in 5.0 seconds = 5898.224 FPS
 29925 frames in 5.0 seconds = 5984.936 FPS
 29787 frames in 5.0 seconds = 5957.285 FPS
 29894 frames in 5.0 seconds = 5978.601 FPS
Volendo si può anche abilitare gli effetti Desktop, ora tutto il necessario è stato attivato.

Dopo l'uso di:
 # nvidia-settings
con versioni di Fedora precedenti alla 16 di controllare che in /etc/X11/xorg.conf sia presente la Section "Files"

==== Ripristinare Plymouth all'avvio del pc ====
Il driver proprietario NVidia non ha il KernelModeSetting, quindi la sua installazione disattiva il boot grafico Plymouth. Il problema è esclusivamente estetico, e solo per quei pochi secondi di avvio di Fedora (tra la schermata di grub e quella del login utente). Tuttavia è possibile ripristinare l'avvio di Plymouth [http://doc.fedoraonline.it/Plymouth#Risoluzioni impostando manualmente la risoluzione video desiderata]

==Installazione dei drivers usando l'installer scaricabile dal sito di nvidia==
Questa procedura non è consigliata agli utenti meno esperti.

Una volta scaricato il package per la propria videocard [http://www.nvidia.it/Download/indexsg.aspx?lang=it dal sito di NVidia], occorrerà procedere in runlevel 3, avviando Fedora in tale stato oppure dando:
 # init 3
Quindi far partire l'installer con
 # sh NVIDIA-Linux-<arch>-<version>-pkgX.run
Usando questo metodo, saranno necessarie alcune librerie; l'installer man mano dirà cosa è necessario.
Personalmente nel sistema ho installato i gruppi "Strumenti di sviluppo" e "Librerie di sviluppo".
Per installarli:
 # yum groupinstall "Strumenti di sviluppo" "Librerie di sviluppo"
(Se avete voglia di battere meno tasti potete dare:
 # yum install @development-tools @development-libs
Se si possiede un sistema a 64 bit, e si vuole che funzionino le "OpenGL 32 bit
compatibility mode", si può installare:
 # yum install glibc*686
Non credo che si avrà bisogno di altro.
Se si ha necessità di disinstallare i drivers nvidia usando questo II metodo occorrerà dare un:
 # nvidia-uninstall
Se si avrà la necessità, l'utility
 # nvidia-xconfig 
genererà un nuovo xorg.conf creando automaticamente anche una copia di
backup

Nel secondo metodo descritto, si avrà lo svantaggio di dover ad ogni aggiornamento dei drivers, procurarsi l'ultima versione e reinstallarli.
Si dovrà fare lo stesso ad ogni nuova versione di kernel che si installerà.

== Riferimenti ==
* http://rpmfusion.org/Howto/nVidia

[[Categoria:Schede grafiche]]
[[Categoria:Modifica in corso]]
