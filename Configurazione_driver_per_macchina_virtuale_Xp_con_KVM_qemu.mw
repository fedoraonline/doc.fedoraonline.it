{{InCorso|autore=VirgilioAgostinelli}}
{{Autore|VirgilioAgostinelli}}

==Introduzione==

L'utilizzo delle macchine virtuali è sempre più diffuso per gli innumerevoli vantaggi che questo può comportare. Innanzitutto l'elevata compatibilità hardware consente l'installazione di una macchina virtuale su qualsiasi sistema x86. Inoltre è possibile compiere test su differenti sistemi operativi senza dover dedicare un computer per ciascun sistema operativo o senza dover riavviare il sistema operativo in caso di dual boot.. Infatti è possibile installare più macchine virtuali all'interno di un unico sistema operativo host.
Può a volte anche essere inevitabile utilizzare sistemi proprietari per lo svolgimento di alcune operazioni e l'installazione di questi sistemi in una macchina virtuale costituisce una valida soluzione.
In questa guida mostreremo i passaggi necessari ad installare un sistema operativo guest XP nel sistema operativo host Fedora 17 attraverso l'utilizzo di kvm, qemu e l'interfaccia grafica virt-manager.

==Preparazione del sistema==

Il primo passo è verificare che il proprio processore supporti la virtualizzazione dell'hardware

 $ grep -E 'svm|vmx' /proc/cpuinfo

Se l'output di questo comando non presenta nulla allora il processore non supporta la virtualizzazione dell'hardware oppure tale virtualizzazione non è stata abilitata. In questo secondo caso è possibile accedere al bios all'avvio del pc e attivare l'opzione.

Qualora invece il processori supporti la virtualizzazione si visualizzeranno vari flags, e a seconda dei casi avremo 'vmx' se il nostro processore è intel, oppure 'svm' se il nostro processore è un amd.

Se il processore è intel dovremo caricare i reltivi moduli con i comandi

 # modprobe kvm
 # modprobe kvm_intel

Se invece abbiamo un processore amd

 # modprobe kvm
 # modprobe kvm_amd

Se tutto è andato a buon fine dovremmo poter verificare una situazione di questo tipo

 $ lsmod | grep kvm 
 kvm_intel             126707  0 
 kvm                   363507  1 kvm_intel

Possiamo proseguire...

==Installazione==

Installiamo i pacchetti necessari per la virtualizzazione
	
	# yum groupinstall @virtualization

	(vorrei inserire i pacchetti che questo comando installa, ma avendoli già installati non so come recuperarli)

Installiamo la macchina virtuale con l'interfaccia grafica Virt-manager

	A questo punto nel menu Applicazioni => Strumenti di Sistema dovrebbe essere comparsa l'icona di Virtual Machine Manager e avviamola, inserendo la password di root quando richiesto.



[[File:vm1.png]]



Cliccando sul primo pulsante a sinistra si apre la seguente finestra.



[[File:vm2.png]]



Inseriamo il nome che vogliamo attribuire alla nuova macchina virtuale e se abbiamo una immagine  iso o un cd di installazione lasciamo invariata la modalità di installazione e procediamo. Cliccando su avanti compare la seguente finestra.



[[File:vm3.png]]



Selezioniamo il supporto di installazione con il percorso corretto, e in “Tipo OS” indichiamo 'Windows' e in “Versione” nel nostro caso 'Microsoft Windows XP'.
La schermata successiva ci chiede di indicare al sistema quanta RAM vogliamo dedicare alla macchina virtuale e quante cpu. La RAM massima gestibile da kvm/qemu è di 2048 MB, mentre per le cpu è consigliabile inserire tutte quelle disponibili.



[[File:vm4.png]]



Nel passo successivo dovremo creare lo spazio sul disco che sarà utilizzato dalla macchina virtuale.
Indichiamo la quantità di spazio che riteniamo opportuna, e se lasciamo le impostazioni come si presentano lo spazio verrà creato nella partizione di sistema dell'host.
È consigliabile marcare l'opzione “Alloca l'intero disco ora”. Questo significa che verrà creato immediatamente tutto lo spazio indicato. In caso contrario verrà creato solo lo spazio necessario all'installazione e il restante verrà allocato dinamicamente al bisogno, rallentando però il funzionamento della macchina virtuale.
Qualora fosse già presente uno spazio dedicato ad una macchina virtuale precedente che si volesse utilizzare per la nuova installazione, oppure se desideriamo ricavare lo spazio per la macchina virtuale in una posizione diversa da quella del file system dell'host, è sufficiente indicarlo cliccando su ”Selezionare managed o altro storage esistente” e indicare il percorso. Se stiamo creando un nuovo storage la sua dimensione sarà comunque quella indicata nel campo precedente dove abbiamo scelto di inserire “13 GB”.



[[File:vm5.png]]



Nell'ultimo passo viene visualizzato un riepilogo dei dati che abbiamo inserito (i nomi attribuiti e evidenziati nella finestra sono puramente indicativi) e ci viene offerta la possibilità di effettuare delle scelte:

“Customize configuration before install”: se clicchiamo sopra ci verrà data la possibilità di effettuare delle configurazioni aggiuntive che al momento non ci interessano per cui possiamo lasciare deselezionato

nelle “Opzioni avanzate” lasciamo tutto come di default, facendo attenzione a non modificare il campo “Tipo virt”. Questo campo deve rimanere 'kvm', perchè in caso contrario non potremo ottimizzare successivamente il nostro disco configurandolo come Virtio.



[[File:vm6.png]]
[[Categoria:Virtualizzazione]]
[[Categoria:Scrittura in corso]]
